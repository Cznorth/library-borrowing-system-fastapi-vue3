@startuml
!include _skin.iuml
actor 读者
participant 前端 as Frontend
participant 后端 as Backend
participant 服务层 as Services
participant 仓储 as Repositories
读者 -> 前端: 点击“借阅”(copy_id)
前端 -> 后端: POST /loans {copy_id}
后端 -> 服务层: LoansService.borrow(copy_id, user)
服务层 -> 仓储: CopiesRepo.lock(copy)
仓储 --> 服务层: 状态可借
服务层 -> 仓储: LoansRepo.create(...)
服务层 -> 仓储: CopiesRepo.update(status=借出)
后端 --> 前端: 成功
@enduml

